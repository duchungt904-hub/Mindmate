{% extends "base.html" %}

{% block title %}ä¸»é¡µ - MindMate{% endblock %}

{% block content %}
<div class="home-container">
    <div class="hero-section">
        <h1>Welcome to MindMate</h1>
        <p class="subtitle">Your Personal AI Companion</p>
    </div>
    
    <div class="features">
        <div class="feature-card">
            <span class="feature-icon">ğŸ’¬</span>
            <h3>Chat</h3>
            <p>ä¸æ‚¨çš„ AI ä¼™ä¼´èŠå¤©ï¼Œè·å¾—æ”¯æŒå’Œé™ªä¼´</p>
            <a href="/chat" class="btn-feature">å¼€å§‹èŠå¤©</a>
        </div>
        
        <div class="feature-card">
            <span class="feature-icon">ğŸ“…</span>
            <h3>Calendar</h3>
            <p>è¿½è¸ªæ‚¨çš„æ¯æ—¥å¿ƒæƒ…ï¼Œäº†è§£æƒ…ç»ªå˜åŒ–</p>
            <a href="/calendar" class="btn-feature">æŸ¥çœ‹æ—¥å†</a>
        </div>
        
        <div class="feature-card">
            <span class="feature-icon">ğŸ¤–</span>
            <h3>Avatar</h3>
            <p>è‡ªå®šä¹‰æ‚¨çš„ AI ä¼™ä¼´å½¢è±¡å’Œæ€§æ ¼</p>
            <a href="/avatar" class="btn-feature">é…ç½® Avatar</a>
        </div>
        
        <div class="feature-card">
            <span class="feature-icon">ğŸ‘¤</span>
            <h3>Profile</h3>
            <p>ç®¡ç†æ‚¨çš„ä¸ªäººèµ„æ–™å’Œåå¥½è®¾ç½®</p>
            <a href="/profile" class="btn-feature">ç¼–è¾‘èµ„æ–™</a>
        </div>
    </div>
    
    <div class="quick-stats">
        <h2>ä»Šæ—¥æ¦‚è§ˆ</h2>
        <div class="stats-grid">
            <div class="stat-item">
                <span class="stat-label">ä»Šæ—¥æ¶ˆæ¯</span>
                <span class="stat-value" id="todayMessages">-</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">ä»Šæ—¥å¿ƒæƒ…</span>
                <span class="stat-value" id="todayMood">-</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
async function loadTodayStats() {
    const today = new Date().toISOString().split('T')[0];
    
    // åŠ è½½ä»Šæ—¥æ¶ˆæ¯æ•°
    try {
        const response = await fetch('/api/chat/history?limit=100');
        const data = await response.json();
        
        if (data.success) {
            const todayMessages = data.history.filter(msg => 
                msg.timestamp.startsWith(today) && msg.sender === 'user'
            ).length;
            document.getElementById('todayMessages').textContent = todayMessages;
        }
    } catch (error) {
        console.error('åŠ è½½æ¶ˆæ¯ç»Ÿè®¡å¤±è´¥:', error);
    }
    
    // åŠ è½½ä»Šæ—¥å¿ƒæƒ…
    try {
        const response = await fetch(`/api/mood/get?date=${today}`);
        const data = await response.json();
        
        if (data.success && data.mood) {
            document.getElementById('todayMood').textContent = data.mood.mood_emoji;
        } else {
            document.getElementById('todayMood').textContent = 'æœªè®°å½•';
        }
    } catch (error) {
        console.error('åŠ è½½å¿ƒæƒ…ç»Ÿè®¡å¤±è´¥:', error);
    }
}

loadTodayStats();
</script>
{% endblock %}
